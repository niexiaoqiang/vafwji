# 飞机棋大战

这是一款完整的网页游戏，支持局域网内联机对战。游戏基于飞机棋规则，双方在10x10的棋盘上摆放飞机，通过猜测对方飞机位置进行攻击，先摧毁对方所有飞机机头的一方获胜。

## 游戏规则

### 游戏准备
- 每位玩家有两个10x10的表格，一个用来摆放自己的飞机，另一个用来标记攻击对方的情况
- 表格的行标为1-10，列标为A-J
- 游戏开始前，玩家需要在自己的棋盘上摆放3架飞机
- 飞机形状：机身长4格，机翼5格（中心位于机身第二格），尾翼3格（中心位于机身尾端）
- 飞机不能出格或相互重叠

### 游戏过程
- 玩家轮流攻击对方棋盘上的格子
- 攻击结果分为三种：
  - "空"（-）：未命中任何飞机部分
  - "伤"（X）：命中飞机非机头部分
  - "沉"（O）：命中飞机机头
- 命中对方飞机机头后可以继续攻击一次
- 游戏目标是摧毁对方所有（三个）飞机的机头

## 项目特点

- 局域网联机对战
- 用户友好的界面设计
- 飞机可自由拖动和旋转摆放
- 实时游戏状态更新
- 游戏日志记录攻击历史
- 支持右键标记功能

## 技术栈

- 前端：Vue 3
- 后端：Node.js + Express
- 实时通信：Socket.io
- 样式：CSS3（动画和阴影效果）

## 安装与运行

1. 确保已安装 Node.js 和 npm
2. 克隆本仓库
3. 安装依赖：

```bash
npm install
```

4. 启动服务器和前端（开发模式）：

```bash
npm run start
```

5. 游戏将在 http://localhost:5173 上运行
6. 在局域网中，其他玩家可以通过访问 http://[您的IP地址]:5173 加入游戏

## 游戏流程

1. 输入用户名并创建房间或加入现有房间
2. 在棋盘上摆放3架飞机（可拖动和旋转）
3. 点击"准备游戏"按钮
4. 等待对方准备就绪，游戏自动开始
5. 轮流攻击对方棋盘，直到有一方摧毁对方所有飞机机头

## 提示

- 右键点击对方棋盘可以添加标记，帮助推测飞机位置
- 命中对方飞机头部后可以继续攻击一次
- 使用游戏日志追踪攻击历史和结果

## 部署方式

### 传统部署（开发/测试环境）

1. 确保已安装 Node.js 和 npm
2. 克隆本仓库
3. 安装依赖：

```bash
npm install
```

4. 启动服务器和前端（开发模式）：

```bash
npm run start
```

5. 游戏将在 http://localhost:5173 上运行

### Docker部署（推荐生产环境）

#### 方式一：使用Docker Compose（推荐）

1. 确保已安装Docker和Docker Compose
2. 在项目根目录执行：

```bash
# 构建并启动容器
docker-compose up -d

# 查看运行状态
docker-compose ps

# 查看日志
docker-compose logs -f
```

3. 游戏将在 http://localhost:3000 上运行

#### 方式二：使用Docker命令

1. 构建镜像：

```bash
docker build -t airplane-game .
```

2. 运行容器：

```bash
docker run -d \
  --name airplane-game \
  -p 3000:3000 \
  --restart unless-stopped \
  airplane-game
```

#### Docker部署优势

- **镜像体积优化**：使用多阶段构建，生产镜像仅包含必要文件
- **安全性提升**：运行在非root用户环境下
- **环境一致性**：确保在任何支持Docker的环境中都能正常运行
- **便于扩展**：可轻松进行水平扩展和负载均衡

#### 管理命令

```bash
# 停止容器
docker-compose down

# 重新构建和启动
docker-compose up -d --build

# 查看容器日志
docker-compose logs airplane-game

# 进入容器调试
docker exec -it airplane-game sh
```

## 局域网访问说明

### Docker部署局域网访问

1. 找到本机IP地址（Windows使用`ipconfig`，Mac/Linux使用`ifconfig`或`ip addr`命令）
2. 确保防火墙允许端口3000的访问
3. 启动Docker容器：`docker-compose up -d`
4. 局域网内其他用户可通过以下地址访问：
   - Docker部署：`http://[你的IP地址]:3000`

### 传统部署局域网访问

1. 确保防火墙允许端口3000和5173的访问
2. 启动应用：`npm run start`
3. 局域网内其他用户可通过以下地址访问：
   - 开发环境：`http://[你的IP地址]:5173`
   - 生产环境：`http://[你的IP地址]:3000`

注意：如果使用传统生产环境，请先执行`npm run build`构建应用。

## 故障排除

### Docker相关问题

**问题：容器启动失败**
```bash
# 检查容器日志
docker-compose logs airplane-game

# 检查容器状态
docker-compose ps
```

**问题：端口被占用**
```bash
# 修改docker-compose.yml中的端口映射
ports:
  - "3001:3000"  # 将主机端口改为3001
```

**问题：Socket.io连接失败**
- 确认防火墙已开放相应端口
- 检查容器网络配置是否正确
- 验证客户端连接的URL是否正确

### 性能优化建议

- 生产环境建议使用Docker部署
- 可考虑使用nginx作为反向代理
- 启用Docker容器资源限制以优化资源使用
